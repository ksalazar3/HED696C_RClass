---
title: "Lecture 11: Working with Strings and Date/Time Variables" # potentially push to header
subtitle:  "Managing and Manipulating Data Using R"
author: 
date: 
classoption: dvipsnames  # for colors
fontsize: 8pt
urlcolor: blue
output:
  beamer_presentation:
    keep_tex: true
    toc: false
    slide_level: 3
    theme: default # AnnArbor # push to header?
    #colortheme: "dolphin" # push to header?
    #fonttheme: "structurebold"
    highlight: tango # Supported styles include "default", "tango", "pygments", "kate", "monochrome", "espresso", "zenburn", and "haddock" (specify null to prevent syntax highlighting); push to header
    df_print: tibble #default # tibble # push to header?    
    latex_engine: xelatex #  Available engines are pdflatex [default], xelatex, and lualatex; The main reasons you may want to use xelatex or lualatex are: (1) They support Unicode better; (2) It is easier to make use of system fonts.
    includes:
      in_header: ../beamer_header.tex
      #after_body: table-of-contents.txt 
---

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>", highlight = TRUE)
#knitr::opts_chunk$set(collapse = TRUE, comment = "#>", highlight = TRUE)
  #comment = "#>" makes it so results from a code chunk start with "#>"; default is "##"
```


# Introduction

### Logistics

__Reading__

- GW chapter 14 (Strings)
- GW chapter 16 (Dates and Times)

__No class next week (11/13)__

- Problem set for strings + date/times still due on 11/13
- No problem set due on 11/20


### What we will do today

\tableofcontents

```{r, eval=FALSE, echo=FALSE}
#Use this if you want TOC to show level 2 headings
\tableofcontents
#Use this if you don't want TOC to show level 2 headings
\tableofcontents[subsectionstyle=hide/hide/hide]
```


### Load the packages we will use today (output omitted) 

- __you must run this code chunk after installing these packages__
```{r warning=FALSE, message=FALSE}
library(tidyverse)
library(stringr)

```
__If package not yet installed__, then must install before you load. Install in "console" rather than .Rmd file

- Generic syntax: `install.packages("package_name")`
- Install "tidyverse": `install.packages("stringr")`

Note: when we load package, name of package is not in quotes; but when we install package, name of package is in quotes:

- `install.packages("tidyverse")`
- `library(tidyverse)`



# Working with Strings

## String basics

### What are strings?
String refers to a "data type" used in programming to represent text rather than numbers (although it can include numbers)

- Strings have `character`types
```{r}
string1<- "Apple"
typeof(string1) #type is charater
```


- Create strings using `" "`
```{r}
string2 <- "This is a string"
```

- If string contains a quotation, use `' " " '`
```{r}
string3 <- 'example of a "quote" within a string'
```

- To print a string, use `writeLines()`
```{r}
print(string3) #will print using \ 
writeLines(string3)
```

### Common uses of strings

Basic uses: 

- Names of files and directories
```{r, results='hide'}
acs_tract <- read_csv("https://raw.githubusercontent.com/ozanj/rclass/master/data/acs/tracts.csv")
```

- Names of elements in data objects
```{r}
num_vec <- 1:5
names(num_vec) <- c('uno', 'dos', 'tres', 'cuatro', 'cinco')
num_vec
```

### Common uses of strings

- Text elements displayed in plots and graphs
```{r}
plot(iris$Petal.Length, iris$Petal.Width, main = 'Title', sub = 'Subtitle', 
     xlab = 'x-axis label', ylab = 'y-axis label', col = 'red')
```


### Common uses of strings

More advanced uses:

- Dealing with identification numbers (leading or trailing zeros)
```{r}
typeof(acs_tract$fips_county_code)

acs_tract <- acs_tract %>% 
  mutate(char_county=
  str_pad(as.character(fips_county_code), side = "left" ,3, pad="0"))
  
```

-Regular expressions
```{r}

```



### Common uses of strings

-Complex reshaping (tidying) of data 

  - Problem: multiple variables crammed into the column names
    - new_ prefix = new cases
    - sp/rel/sp/ep describe how the case was diagnosed
    - m/f gives the gender
    - digits are age ranges
  
```{r, eval=FALSE, echo=FALSE}
# explore WHO data
# tuberculosis cases broken down by year, country, age, gender, and diagnosis method
View(who)
names(who)
```

```{r, results="hide"}
who %>% pivot_longer(
  cols = new_sp_m014:newrel_f65,
  names_to = c("diagnosis", "gender", "age"), 
  names_pattern = "new_?(.*)_(.)(.*)", 
  values_to = "count"
)
```

